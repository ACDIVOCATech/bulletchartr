var ggiraphjs=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=d3},function(t,e,n){"use strict";var i;!function(){var n=e||{}||this||window;void 0===(i=function(){return n}.apply(e,[]))||(t.exports=i);var r="http://www.w3.org/2000/xmlns/",o=/url\(["']?(.+?)["']?\)/,a={woff2:"font/woff2",woff:"font/woff",otf:"application/x-font-opentype",ttf:"application/x-font-ttf",eot:"application/vnd.ms-fontobject",sfnt:"application/font-sfnt",svg:"image/svg+xml"},s=function(t){if(!((e=t)instanceof HTMLElement||e instanceof SVGElement))throw new Error("an HTMLElement or SVGElement is required; got "+t);var e},l=function(t,e,n){var i=t.viewBox&&t.viewBox.baseVal&&t.viewBox.baseVal[n]||null!==e.getAttribute(n)&&!e.getAttribute(n).match(/%$/)&&parseInt(e.getAttribute(n))||t.getBoundingClientRect()[n]||parseInt(e.style[n])||parseInt(window.getComputedStyle(t).getPropertyValue(n));return null==i||isNaN(parseFloat(i))?0:i},c=function(t){for(var e=window.atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(e.length),r=new Uint8Array(i),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return new Blob([i],{type:n})},d=function(t){return Promise.all(Array.from(t.querySelectorAll("image")).map(function(t){var e,n=t.getAttributeNS("http://www.w3.org/1999/xlink","href")||t.getAttribute("href");return n?((e=n)&&0===e.lastIndexOf("http",0)&&-1===e.lastIndexOf(window.location.host)&&(n+=(-1===n.indexOf("?")?"?":"&")+"t="+(new Date).valueOf()),new Promise(function(e,i){var r=document.createElement("canvas"),o=new Image;o.crossOrigin="anonymous",o.src=n,o.onerror=function(){return i(new Error("Could not load "+n))},o.onload=function(){r.width=o.width,r.height=o.height,r.getContext("2d").drawImage(o,0,0),t.setAttributeNS("http://www.w3.org/1999/xlink","href",r.toDataURL("image/png")),e(!0)}})):Promise.resolve(null)}))},u={},h=function(t){return Promise.all(t.map(function(t){return new Promise(function(e,n){if(u[t.url])return e(u[t.url]);var i=new XMLHttpRequest;i.addEventListener("load",function(){var n=function(t){for(var e="",n=new Uint8Array(t),i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return window.btoa(e)}(i.response),r=t.text.replace(o,'url("data:'+t.format+";base64,"+n+'")')+"\n";u[t.url]=r,e(r)}),i.addEventListener("error",function(n){console.warn("Failed to load font from: "+t.url,n),u[t.url]=null,e(null)}),i.addEventListener("abort",function(n){console.warn("Aborted loading font from: "+t.url,n),e(null)}),i.open("GET",t.url),i.responseType="arraybuffer",i.send()})})).then(function(t){return t.filter(function(t){return t}).join("")})},f=null,p=function(t,e){var n=e||{},i=n.selectorRemap,r=n.modifyStyle,s=n.modifyCss,l=n.fonts,c=s||function(t,e){return(i?i(t):t)+"{"+(r?r(e):e)+"}\n"},d=[],u=void 0===l,p=l||[];return(f||(f=Array.from(document.styleSheets).map(function(t){try{return{rules:t.cssRules,href:t.href}}catch(e){return console.warn("Stylesheet could not be loaded: "+t.href,e),{}}}))).forEach(function(e){var n=e.rules,i=e.href;n&&Array.from(n).forEach(function(e){if(void 0!==e.style)if(function(t,e){if(e)try{return t.querySelector(e)||t.parentNode&&t.parentNode.querySelector(e)}catch(t){console.warn('Invalid CSS selector "'+e+'"',t)}}(t,e.selectorText))d.push(c(e.selectorText,e.style.cssText));else if(u&&e.cssText.match(/^@font-face/)){var n=function(t,e){var n=t.cssText.match(o),i=n&&n[1]||"";if(i&&!i.match(/^data:/)&&"about:blank"!==i){var r,s,l=i.startsWith("../")?e+"/../"+i:i.startsWith("./")?e+"/."+i:i;return{text:t.cssText,format:(r=l,s=Object.keys(a).filter(function(t){return r.indexOf("."+t)>0}).map(function(t){return a[t]}),s?s[0]:(console.error("Unknown font format for "+r+". Fonts may not be working correctly."),"application/octet-stream")),url:l}}}(e,i);n&&p.push(n)}else d.push(e.cssText)})}),h(p).then(function(t){return d.join("\n")+t})};n.prepareSvg=function(t,e,n){s(t);var i=e||{},o=i.left,a=void 0===o?0:o,c=i.top,u=void 0===c?0:c,h=i.width,f=i.height,g=i.scale,v=void 0===g?1:g,m=i.responsive,y=void 0!==m&&m;return d(t).then(function(){var i=t.cloneNode(!0),o=(e||{}).backgroundColor,s=void 0===o?"transparent":o;i.style.backgroundColor=s;var c=function(t,e,n,i){if("svg"===t.tagName)return{width:n||l(t,e,"width"),height:i||l(t,e,"height")};if(t.getBBox){var r=t.getBBox(),o=r.x,a=r.y;return{width:o+r.width,height:a+r.height}}}(t,i,h,f),d=c.width,g=c.height;if("svg"!==t.tagName){if(!t.getBBox)return void console.error("Attempted to render non-SVG element",t);i.setAttribute("transform",i.getAttribute("transform").replace(/translate\(.*?\)/,""));var m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.appendChild(i),i=m}return i.setAttribute("version","1.1"),i.setAttribute("viewBox",[a,u,d,g].join(" ")),i.getAttribute("xmlns")||i.setAttributeNS(r,"xmlns","http://www.w3.org/2000/svg"),i.getAttribute("xmlns:xlink")||i.setAttributeNS(r,"xmlns:xlink","http://www.w3.org/1999/xlink"),y?(i.removeAttribute("width"),i.removeAttribute("height"),i.setAttribute("preserveAspectRatio","xMinYMin meet")):(i.setAttribute("width",d*v),i.setAttribute("height",g*v)),Array.from(i.querySelectorAll("foreignObject > *")).forEach(function(t){t.getAttribute("xmlns")||t.setAttributeNS(r,"xmlns","http://www.w3.org/1999/xhtml")}),p(t,e).then(function(t){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML="<![CDATA[\n"+t+"\n]]>";var r=document.createElement("defs");r.appendChild(e),i.insertBefore(r,i.firstChild);var o=document.createElement("div");o.appendChild(i);var a=o.innerHTML.replace(/NS\d+:href/gi,'xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href');if("function"!=typeof n)return{src:a,width:d,height:g};n(a,d,g)})})},n.svgAsDataUri=function(t,e,i){s(t);var r=n.prepareSvg(t,e).then(function(t){var e=t.src;return"data:image/svg+xml;base64,"+window.btoa(decodeURIComponent(encodeURIComponent('<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" [<!ENTITY nbsp "&#160;">]>'+e).replace(/%([0-9A-F]{2})/g,function(t,e){var n=String.fromCharCode("0x"+e);return"%"===n?"%25":n})))});return"function"==typeof i?r.then(i):r},n.svgAsPngUri=function(t,e,i){s(t);var r=e||{},o=r.encoderType,a=void 0===o?"image/png":o,l=r.encoderOptions,c=void 0===l?.8:l,d=r.canvg,u=function(t){var e=t.src,n=t.width,r=t.height,o=document.createElement("canvas"),s=o.getContext("2d"),l=window.devicePixelRatio||1;o.width=n*l,o.height=r*l,o.style.width=o.width+"px",o.style.height=o.height+"px",s.setTransform(l,0,0,l,0,0),d?d(o,e):s.drawImage(e,0,0);var u=void 0;try{u=o.toDataURL(a,c)}catch(t){if("undefined"!=typeof SecurityError&&t instanceof SecurityError||"SecurityError"===t.name)return void console.error("Rendered SVG images cannot be downloaded in this browser.");throw t}return"function"==typeof i&&i(u),Promise.resolve(u)};return d?n.prepareSvg(t,e).then(u):n.svgAsDataUri(t,e).then(function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){return e(u({src:i,width:i.width,height:i.height}))},i.onerror=function(){n("There was an error loading the data URI as an image on the following SVG\n"+window.atob(t.slice(26))+"Open the following link to see browser's diagnosis\n"+t)},i.src=t})})},n.download=function(t,e){if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(c(e),t);else{var n=document.createElement("a");if("download"in n){n.download=t,n.style.display="none",document.body.appendChild(n);try{var i=c(e),r=URL.createObjectURL(i);n.href=r,n.onclick=function(){return requestAnimationFrame(function(){return URL.revokeObjectURL(r)})}}catch(t){console.warn("This browser does not support object URLs. Falling back to string URL."),n.href=e}n.click(),document.body.removeChild(n)}else window.open(e,"_temp","menubar=no,toolbar=no,status=no")}},n.saveSvg=function(t,e,i){s(t),n.svgAsDataUri(t,i||{},function(t){return n.download(e,t)})},n.saveSvgAsPng=function(t,e,i){s(t),n.svgAsPngUri(t,i||{},function(t){return n.download(e,t)})}}()},function(t,e,n){t.exports=n(3)},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(1);function o(){var t,e=navigator.userAgent,n=e.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((t=/\brv[ :]+(\d+)/g.exec(e)||[])[1]||""):"Chrome"===n[1]&&null!==(t=e.match(/\b(OPR|Edge)\/(\d+)/))?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(t=e.match(/version\/(\d+)/i))&&n.splice(1,1,t[1]),n.join(" "))}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerid=e,this.dataSelected=[],this.typeSelection=null,this.svgid=null,this.inputId=null,this.zoomer=null}var e,n,s;return e=t,(n=[{key:"setSvgId",value:function(t){this.svgid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return"id"+t()+t()}(),this.uid=t}},{key:"setZoomer",value:function(t,e){this.zoomer=i.zoom().scaleExtent([t,e])}},{key:"tooltipClassname",value:function(){return"tooltip_"+this.svgid}},{key:"selectedClassname",value:function(){return"clicked_"+this.svgid}},{key:"hoverClassname",value:function(){return"hover_"+this.svgid}},{key:"addStyle",value:function(t,e,n){var r=i.select("#"+this.containerid+" style");r.size()>0&&r.remove();var o=".tooltip_"+this.svgid+t+"\n.hover_"+this.svgid+e+"\n.clicked_"+this.svgid+n+"\n";i.select("#"+this.containerid).append("style").text(o)}},{key:"setInputId",value:function(t){this.inputId=t}},{key:"addUI",value:function(t,e,n,i){!function(t,e,n,i,o){var a=d3.select("#"+t.containerid+" .girafe_container_std").append("div").classed("ggiraph-toolbar",!0);if(a.classed(o,!0),e){var s=a.append("div").classed("ggiraph-toolbar-block",!0).classed("shinyonly",!0);s.append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","lasso selection").on("click",function(){t.lasso_on(!0)}).html("<svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>"),s.append("a").classed("ggiraph-toolbar-icon",!0).classed("drop",!0).attr("title","lasso selection").on("click",function(){t.lasso_on(!1)}).html("<svg width='15pt' height='15pt' viewBox='0 0 230 230'><g><ellipse ry='65.5' rx='86.5' cy='94' cx='115.5' stroke-width='20' fill='transparent'/><ellipse ry='11.500001' rx='10.5' cy='153' cx='91.5' stroke-width='20' fill='transparent'/><line y2='210.5' x2='105' y1='164.5' x1='96' stroke-width='20'/></g></svg>")}if(n){var l=a.append("div").classed("ggiraph-toolbar-block",!0);l.append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","pan-zoom reset").on("click",function(){t.zoomIdentity()}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><polygon points='274,209.7 337.9,145.9 288,96 416,96 416,224 366.1,174.1 302.3,238 '/><polygon points='274,302.3 337.9,366.1 288,416 416,416 416,288 366.1,337.9 302.3,274'/><polygon points='238,302.3 174.1,366.1 224,416 96,416 96,288 145.9,337.9 209.7,274'/><polygon points='238,209.7 174.1,145.9 224,96 96,96 96,224 145.9,174.1 209.7,238'/></g><svg>"),l.append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","activate pan-zoom").on("click",function(){t.zoomOn()}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/></g></svg>"),l.append("a").classed("ggiraph-toolbar-icon",!0).classed("drop",!0).attr("title","deactivate pan-zoom").on("click",function(){t.zoomOff()}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512'><g><ellipse ry='150' rx='150' cy='213' cx='203.5' stroke-width='50' fill='transparent'/><line y2='455.5' x2='416' y1='331.5' x1='301' stroke-width='50'/><line y2='455' x2='0' y1='0' x1='416' stroke-width='30'/></g></svg>")}i&&a.append("div").classed("ggiraph-toolbar-block",!0).append("a").classed("ggiraph-toolbar-icon",!0).classed("neutral",!0).attr("title","download png").on("click",function(){"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?r.saveSvgAsPng(document.getElementById(t.svgid),"diagram.png"):console.error("This navigator does not support Promises")}).html("<svg width='15pt' height='15pt' viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'><g><polygon points='95 275 95 415 415 415 415 275 375 275 375 380 135 380 135 275'/><polygon points='220 30 220 250 150 175 150 245 250 345 350 245 350 175 280 250 280 30'/></g></svg>")}(this,t,e,n,i)}},{key:"removeContent",value:function(){var t=i.select("#"+this.containerid+" .girafe_container_std svg");t.size()>0&&i.select(".tooltip_"+t.attr("id")).remove();var e=i.select("#"+this.containerid+" div.girafe_container_std");e.size()>0&&e.remove();var n="."+this.tooltipClassname(),r=i.select(n);r.size()>0&&r.remove()}},{key:"addSvg",value:function(t,e){this.removeContent(),i.select("#"+this.containerid).append("div").attr("class","girafe_container_std").html(t),i.select("body").append("div").attr("class",this.tooltipClassname()).style("position","absolute").style("opacity",0),function(t){var e=t.indexOf("{"),n=t.substring(e+1,t.lastIndexOf("}")),i=t.substring(0,e),r=i.substring(i.indexOf("(")+1,i.lastIndexOf(")")).split(",");function o(){return Function.apply(this,r)}return r.push(n),o.prototype=Function.prototype,new o}(e)(),i.select("#"+this.uid).attr("id",this.svgid)}},{key:"IEFixResize",value:function(t,e){if("IE 11"==o()||"MSIE"===o().substring(0,4)){var n=this.containerid,r=this.svgid;i.select("#"+r).classed("girafe_svg_ie",!0),i.select("#"+n+" div").classed("girafe_container_ie",!0).style("width",Math.round(100*t)+"%").style("padding-bottom",Math.round(t*e*100)+"%")}}},{key:"autoScale",value:function(t){var e=this.svgid;i.select("#"+e).style("width",t).style("height","100%").style("margin-left","auto").style("margin-right","auto")}},{key:"fixSize",value:function(t,e){var n=this.containerid,r=this.svgid;i.select("#"+r).attr("preserveAspectRatio","xMidYMin meet"),i.select("#"+n+" .girafe_container_std").style("width","100%"),i.select("#"+r).attr("width",t).attr("height",e),i.select("#"+r).style("width",t).style("height",e)}},{key:"setSizeLimits",value:function(t,e,n,r){var o=this.svgid;i.select("#"+o).style("max-width",t).style("max-height",n).style("min-width",e).style("min-height",r)}},{key:"removeContainerLimits",value:function(){if("IE 11"==o()||"MSIE"===o().substring(0,4));else{var t=this.containerid;i.select("#"+t).style("width",null).style("height",null)}}},{key:"animateToolbar",value:function(){var t=this.containerid;i.select("#"+t).on("mouseover",function(e){i.select("#"+t+" div.ggiraph-toolbar").transition().duration(200).style("opacity",.8)}).on("mouseout",function(e){i.select("#"+t+" div.ggiraph-toolbar").transition().duration(500).style("opacity",0)})}},{key:"animateGElements",value:function(t,e,n,r,o,a,s,l){var c=this.hoverClassname(),d=i.selectAll("#"+this.svgid+" *"),u="."+this.tooltipClassname(),h=this.svgid,f=this.containerid;d.on("mouseover",function(a){null!==this.getAttribute("data-id")&&i.selectAll("#"+h+' *[data-id="'+this.getAttribute("data-id")+'"]').classed(c,!0);if(null!==this.getAttribute("title")){if(i.select(u).transition().duration(o).style("opacity",t),s){var d=this.getAttribute("fill");i.select(u).style("background-color",d)}if(l){var p=this.getAttribute("stroke");i.select(u).style("border-color",p)}if(i.select(u).html(this.getAttribute("title")),r)i.select(u).style("left",i.event.pageX+e+"px").style("top",i.event.pageY+n+"px");else{var g=i.select("#"+f).node().getBoundingClientRect();i.select(u).style("left",e+g.left+"px").style("top",document.documentElement.scrollTop+g.y+n+"px")}}}).on("mousemove",function(t){if(null!==this.getAttribute("title"))if(r)i.select(u).style("left",i.event.pageX+e+"px").style("top",i.event.pageY+n+"px");else{var o=i.select("#"+f).node().getBoundingClientRect();i.select(u).style("left",e+o.left+"px").style("top",document.documentElement.scrollTop+o.y+n+"px")}}).on("mouseout",function(t){null!==this.getAttribute("data-id")&&i.selectAll("#"+h+' *[data-id="'+i.select(i.event.currentTarget).attr("data-id")+'"]').classed(c,!1);null!==this.getAttribute("title")&&i.select(u).transition().duration(a).style("opacity",0)})}},{key:"setSelected",value:function(t){this.dataSelected=t,this.refreshSelected(),this.inputId&&Shiny.onInputChange(this.inputId,this.dataSelected)}},{key:"selectizeMultiple",value:function(){var t=i.selectAll("#"+this.svgid+" *[data-id]"),e=this;t.on("click",function(t,n){var r=e.dataSelected,o=i.select(this).attr("data-id"),a=r.indexOf(o);a<0?r.push(o):r.splice(a,1),e.dataSelected=r,e.refreshSelected(),e.inputId&&Shiny.onInputChange(e.inputId,e.dataSelected)})}},{key:"selectizeSingle",value:function(){var t=i.selectAll("#"+this.svgid+" *[data-id]"),e=this;t.on("click",function(t,n){var r=e.dataSelected,o=i.select(this).attr("data-id"),a=r.indexOf(o);r=a<0?[o]:[],e.dataSelected=r,e.refreshSelected(),e.inputId&&Shiny.onInputChange(e.inputId,e.dataSelected)})}},{key:"selectizeNone",value:function(){i.selectAll("#"+this.svgid+" *[data-id]").on("click",null)}},{key:"refreshSelected",value:function(){var t=this.selectedClassname(),e=this.svgid,n=i.select("#"+e);n.selectAll("*[data-id]").classed(t,!1);var r=this;i.selectAll(r.dataSelected).each(function(e,i){n.selectAll('*[data-id="'+r.dataSelected[i]+'"]').classed(t,!0)})}},{key:"zoomOn",value:function(){var t=this.svgid;i.select("#"+this.containerid).call(this.zoomer.on("zoom",function(){i.select("#"+t+" g").attr("transform",i.event.transform)}))}},{key:"zoomIdentity",value:function(){i.select("#"+this.containerid).call(this.zoomer.transform,i.zoomIdentity)}},{key:"zoomOff",value:function(){i.select("#"+this.containerid).call(this.zoomer.on("zoom",null))}},{key:"isSelectable",value:function(){var t=this.svgid;return i.select("#"+t).selectAll("*[data-id]").size()>0}},{key:"lasso_on",value:function(t){var e=this.svgid,n=this,r=i.lasso();r=r.closePathSelect(!0).closePathDistance(100).items(i.select("#"+e).selectAll("*[data-id]")).targetArea(i.select("#"+e)).on("start",function(){}).on("draw",function(){}).on("end",function(){r.selectedItems().each(function(e,r){i.select(this).classed(n.selectedClassname,!0);var o=i.select(this).attr("data-id"),a=n.dataSelected.indexOf(o);a<0&&t?n.dataSelected.push(o):a>=0&&!t&&n.dataSelected.splice(a,1)}),n.refreshSelected(),i.select("#"+e).on(".dragstart",null).on(".drag",null).on(".dragend",null),n.inputId&&Shiny.onInputChange(n.inputId,n.dataSelected)}),i.select("#"+e).call(r)}}])&&a(e.prototype,n),s&&a(e,s),t}();function l(t){return new s(t)}n.d(e,"newgi",function(){return l})}]);